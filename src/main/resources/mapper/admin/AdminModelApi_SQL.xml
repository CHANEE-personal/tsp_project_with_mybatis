<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tsp.new_tsp_project.api.admin.model.service.impl.AdminModelMapper">

	<!-- 모델 수 조회 -->
	<select id="getModelListCnt" parameterType="java.util.HashMap" resultType="Integer">
		/*[AdminModelApi_SQL.xml].[getModelListCnt] */
		SELECT COUNT(*)
		FROM tsp_model
		WHERE visible = 'Y'
	</select>

	<!-- 모델 리스트 출력 -->
	<select id="getModelList" parameterType="java.util.HashMap" resultType="adminModelDto">
		/*[AdminModelApi_SQL.xml].[getModelList] */
		SELECT tm.idx,
			   tm.category_cd,
			   tm.category_nm,
			   tm.model_kor_name,
			   tm.model_eng_name,
			   tm.model_description,
			   tm.visible,
			   tmo.height,
			   tmo.size3,
			   tmo.shoes
		FROM tsp_model tm,
			 tsp_model_opt tmo
		WHERE tm.idx = tmo.model_idx
		ORDER BY tm.idx ASC
			LIMIT #{startPage}, #{size}
	</select>

	<select id="getModelInfo" parameterType="adminModelDto" resultType="java.util.HashMap">
		/*[AdminModelApi_SQL.xml].[getModelInfo] */
		SELECT tm.idx,
			   tm.category_cd,
			   tm.category_nm,
			   tm.model_kor_name,
		       tm.model_eng_name,
			   tm.model_description,
			   tm.visible,
		       tmo.height,
		       tmo.size3,
		       tmo.shoes
		FROM tsp_model tm,
		     tsp_model_opt tmo
		WHERE tm.idx = tmo.model_idx
		  AND tm.visible = 'Y'
		  AND tm.category_cd = #{categoryCd}
		  AND tm.idx = #{idx}
	</select>

	<insert id="insertMenModel" parameterType="adminModelDto" useGeneratedKeys="true" keyProperty="idx">
		INSERT INTO tsp_model(category_cd,
							  category_nm,
							  model_kor_name,
		                      model_eng_name,
		                      model_description,
		                      visible,
							  creator,
							  create_time,
							  updater,
							  update_time)
		VALUES (#{categoryCd},
				#{categoryNm},
				#{modelKorName},
				#{modelEngName},
		        #{modelDescription},
		        #{visible},
		        '1',
		        now(),
		        '1',
		        now())
	</insert>

	<insert id="insertModelOpt" parameterType="adminModelDto" useGeneratedKeys="true" keyProperty="idx">
		INSERT INTO tsp_model_opt(model_idx,
							  	  height,
								  size3,
		                          shoes,
		                          creator,
		                          create_time,
		                          updater,
		                          update_time)
		VALUES (#{modelIdx},
				#{height},
				#{size3},
				#{shoes},
				'1',
				now(),
				'1',
				now())
	</insert>
</mapper>